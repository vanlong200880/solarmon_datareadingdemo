{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"Studio.libraries['react']\"","webpack:///external \"Studio\"","webpack:///./studio/AssetUploadButton.js","webpack:///./studio/main_dev.js","webpack:///./studio/AssetEditor.js","webpack:///external \"Studio.libraries['superagent']\"","webpack:///external \"Studio.libraries['bluebird']\"","webpack:///./node_modules/react-copy-to-clipboard/lib/index.js","webpack:///./node_modules/react-copy-to-clipboard/lib/Component.js","webpack:///./node_modules/copy-to-clipboard/index.js","webpack:///./node_modules/toggle-selection/index.js","webpack:///./studio/AssetEditor.scss","webpack:///./studio/NewAssetModal.js","webpack:///./studio/AssetProperties.js"],"names":["_fileUploadButton","AssetUploadButton","e","target","files","length","assetDefaults","targetAsset","uploadCallback","file","reader","FileReader","onloadend","refs","value","type","Studio","workspaces","save","asset","Object","assign","content","result","substring","indexOf","name","api","post","data","response","__entitySet","addExistingEntity","openTab","updateEntity","patch","_id","link","loadEntity","onerror","errMsg","Error","alert","readAsDataURL","defaults","opts","targetAssetIdAndName","props","tab","entity","dispatchEvent","MouseEvent","window","display","upload","renderUpload","openFileDialog","undefined","Component","addEntitySet","faIcon","visibleName","onNew","options","openModal","NewAssetModal","referenceAttributes","entityTreePosition","addEditorComponent","AssetEditor","addToolbarComponent","addPropertiesComponent","AssetProperties","title","entityTreeIconResolvers","push","parts","split","extension","isSharedHelper","binaryExtensions","getTextFromApi","path","Promise","resolve","reject","request","superagent","get","resolveUrl","end","err","text","toString","state","initialLoading","helpersActive","previewOpen","previewLoading","previewLoadFinish","bind","setState","saveEntity","responseType","ab","str","String","fromCharCode","apply","Uint8Array","fixedStr","decodeURIComponent","escape","btoa","unescape","encodeURIComponent","prevProps","message","match","embeddingCode","isImage","resolveEntityPath","isFont","getFormat","isOfficeFile","lazyPreview","previewEnabled","extensions","assets","officePreview","enabled","onPreview","getLazyPreviewStatus","getPreviewEnabledStatus","showWarning","getSettingValueByKey","setSetting","clearPreview","preview","startProgress","stopProgress","done","OpenUpload","helpersEntity","displayName","icon","onDownload","onUpload","getEmbeddingCode","style","toolbarContainer","toolbarRow","toolbarAssetName","ev","preventDefault","downloadEl","document","createElement","href","click","cb","wasOpen","change","store","dispatch","entities","actions","flushUpdates","margin","emptyMessage","getPreviewContent","onUpdate","v","helpers","padding","overflow","Date","getTime","newStyle","appendChild","createTextNode","head","fontFamily","isPdf","height","includes","renderBinary","mode","forceUpdate","atob","renderEditorToolbar","renderEditorContent","defaultProps","isLink","key","createAsset","setTimeout","focus","error","fragments","close","handleKeyPress","allowAssetsLinkedToFiles","color","opacity","OpenUploadNew","propTypes","PropTypes","func","isRequired","onChange","checked"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n","module.exports = Studio.libraries['react'];","module.exports = Studio;","import React, { Component } from 'react'\nimport Studio from 'jsreport-studio'\n\nlet _fileUploadButton\n\nexport default class AssetUploadButton extends Component {\n  // we need to have global action in main_dev which is triggered when users clicks on + on images\n  // this triggers invisible button in the toolbar\n  static OpenUpload (opts) {\n    _fileUploadButton.openFileDialog('edit', undefined, opts)\n  }\n\n  static OpenUploadNew (defaults, opts) {\n    _fileUploadButton.openFileDialog('new', defaults, opts)\n  }\n\n  componentDidMount () {\n    _fileUploadButton = this\n  }\n\n  upload (e) {\n    if (!e.target.files.length) {\n      return\n    }\n\n    const assetDefaults = e.target.assetDefaults\n    const targetAsset = e.target.targetAsset\n    const uploadCallback = e.target.uploadCallback\n\n    delete e.target.assetDefaults\n    delete e.target.targetAsset\n    delete e.target.uploadCallback\n\n    const file = e.target.files[0]\n    const reader = new FileReader()\n\n    reader.onloadend = async () => {\n      this.refs.file.value = ''\n\n      if (this.type === 'new') {\n        if (Studio.workspaces) {\n          await Studio.workspaces.save()\n        }\n\n        let asset = {}\n\n        if (assetDefaults != null) {\n          asset = Object.assign(asset, assetDefaults)\n        }\n\n        asset = Object.assign(asset, {\n          content: reader.result.substring(reader.result.indexOf('base64,') + 'base64,'.length),\n          name: file.name\n        })\n\n        let response = await Studio.api.post('/odata/assets', {\n          data: asset\n        })\n\n        response.__entitySet = 'assets'\n\n        Studio.addExistingEntity(response)\n        Studio.openTab(Object.assign({}, response))\n      }\n\n      if (this.type === 'edit') {\n        if (Studio.workspaces) {\n          Studio.updateEntity({\n            name: targetAsset.name,\n            content: reader.result.substring(reader.result.indexOf('base64,') + 'base64,'.length)\n          })\n\n          await Studio.workspaces.save()\n        } else {\n          await Studio.api.patch(`/odata/assets(${targetAsset._id})`, {\n            data: {\n              content: reader.result.substring(reader.result.indexOf('base64,') + 'base64,'.length),\n              link: null\n            }\n          })\n          Studio.loadEntity(targetAsset._id, true)\n        }\n      }\n\n      if (uploadCallback) {\n        uploadCallback()\n      }\n    }\n\n    reader.onerror = function () {\n      const errMsg = 'There was an error reading the file!'\n\n      if (uploadCallback) {\n        uploadCallback(new Error(errMsg))\n      }\n\n      alert(errMsg)\n    }\n\n    reader.readAsDataURL(file)\n  }\n\n  openFileDialog (type, defaults, opts = {}) {\n    const targetAssetIdAndName = opts.targetAsset\n\n    this.type = type\n\n    if (defaults) {\n      this.refs.file.assetDefaults = defaults\n    } else {\n      delete this.refs.file.assetDefaults\n    }\n\n    if (targetAssetIdAndName) {\n      this.refs.file.targetAsset = targetAssetIdAndName\n    } else if (type !== 'new') {\n      this.refs.file.targetAsset = {\n        _id: this.props.tab.entity._id,\n        name: this.props.tab.entity.name\n      }\n    }\n\n    if (opts.uploadCallback) {\n      this.refs.file.uploadCallback = opts.uploadCallback\n    } else {\n      delete this.refs.file.uploadCallback\n    }\n\n    this.refs.file.dispatchEvent(new MouseEvent('click', {\n      'view': window,\n      'bubbles': false,\n      'cancelable': true\n    }))\n  }\n\n  renderUpload () {\n    return <input type='file' key='file' ref='file' style={{display: 'none'}} onChange={(e) => this.upload(e)} />\n  }\n\n  render () {\n    return this.renderUpload(true)\n  }\n}\n","import AssetEditor from './AssetEditor.js'\nimport AssetUploadButton from './AssetUploadButton.js'\nimport NewAssetModal from './NewAssetModal.js'\nimport AssetProperties from './AssetProperties.js'\nimport Studio from 'jsreport-studio'\n\nStudio.addEntitySet({\n  name: 'assets',\n  faIcon: 'fa-file',\n  visibleName: 'asset',\n  onNew: (options) => Studio.openModal(NewAssetModal, options),\n  referenceAttributes: ['isSharedHelper'],\n  entityTreePosition: 700\n})\n\nStudio.addEditorComponent('assets', AssetEditor)\n\nStudio.addToolbarComponent(AssetUploadButton)\nStudio.addPropertiesComponent(AssetProperties.title, AssetProperties, (entity) => entity.__entitySet === 'assets')\n\nStudio.entityTreeIconResolvers.push((entity) => {\n  if (entity.__entitySet !== 'assets') {\n    return\n  }\n\n  const parts = entity.name.split('.')\n\n  if (parts.length === 1) {\n    return\n  }\n\n  const extension = parts[parts.length - 1]\n\n  switch (extension) {\n    case 'html': return 'fa-html5'\n    case 'jpg':\n    case 'jpeg':\n    case 'png':\n    case 'gif':\n    case 'svg': return 'fa-camera'\n    case 'js': return entity.isSharedHelper ? 'fa-cogs' : 'fa-cog'\n    case 'css': return 'fa-css3'\n    default: return 'fa-file-o '\n  }\n})\n","import React, { Component } from 'react'\r\nimport AssetUploadButton from './AssetUploadButton.js'\r\nimport Studio, { Preview, TextEditor } from 'jsreport-studio'\r\nimport superagent from 'superagent'\r\nimport Promise from 'bluebird'\r\nimport CopyToClipboard from 'react-copy-to-clipboard'\r\nimport binaryExtensions from 'binary-extensions'\r\nimport style from './AssetEditor.scss'\r\n\r\nbinaryExtensions.push('p12')\r\n\r\n// Studio.api currently always open dialogs on failures and that is what we don't want, so arbitrary implementaiton here\r\nconst getTextFromApi = (path) => {\r\n  return new Promise((resolve, reject) => {\r\n    const request = superagent.get(Studio.resolveUrl(path))\r\n    request.end((err, { text } = {}) => err ? reject(new Error(text || err.toString())) : resolve(text))\r\n  })\r\n}\r\n\r\nclass AssetEditor extends Component {\r\n  constructor (props) {\r\n    super(props)\r\n\r\n    this.state = {\r\n      initialLoading: true,\r\n      helpersActive: false,\r\n      previewOpen: false,\r\n      previewLoading: false\r\n    }\r\n\r\n    this.previewLoadFinish = this.previewLoadFinish.bind(this)\r\n  }\r\n\r\n  async componentDidMount () {\r\n    const { entity } = this.props\r\n\r\n    if (!entity) {\r\n      return this.setState({\r\n        initialLoading: false\r\n      })\r\n    }\r\n\r\n    let content = entity.content\r\n\r\n    if (entity.link) {\r\n      await Studio.saveEntity(entity._id)\r\n      const ab = await Studio.api.get(`assets/${entity._id}/content`, { responseType: 'arraybuffer' })\r\n      const str = String.fromCharCode.apply(null, new Uint8Array(ab))\r\n      const fixedStr = decodeURIComponent(escape(str))\r\n      content = btoa(unescape(encodeURIComponent(fixedStr)))\r\n    }\r\n\r\n    this.setState({ content, initialLoading: false })\r\n  }\r\n\r\n  async componentDidUpdate (prevProps) {\r\n    const { entity } = this.props\r\n\r\n    if (!entity) {\r\n      return\r\n    }\r\n\r\n    if (entity.link && (!this.state.link || prevProps.entity.link !== entity.link)) {\r\n      try {\r\n        const link = await getTextFromApi(`assets/link/${encodeURIComponent(entity.link)}`)\r\n        this.setState({ link: link })\r\n      } catch (e) {\r\n        this.setState({ link: e.message })\r\n      }\r\n    }\r\n  }\r\n\r\n  isOfficeFile (entity) {\r\n    if (entity == null) { return false }\r\n    return entity.name.match(/\\.(docx|xlsx|pptx)$/) != null\r\n  }\r\n\r\n  isImage (entity) {\r\n    if (entity == null) { return false }\r\n    return entity.name.match(/\\.(jpeg|jpg|gif|png|svg)$/) != null\r\n  }\r\n\r\n  isFont (entity) {\r\n    if (entity == null) { return false }\r\n    return entity.name.match(/\\.(otf|woff|ttf|eot|woff2)$/) != null\r\n  }\r\n\r\n  isPdf (entity) {\r\n    if (entity == null) { return false }\r\n    return entity.name.match(/\\.(pdf)$/) != null\r\n  }\r\n\r\n  getFormat (extension) {\r\n    switch (extension) {\r\n      case 'ttf': return 'truetype'\r\n      case 'woff2': return 'woff2'\r\n      case 'eot': return 'embedded-opentype'\r\n      default: return 'woff'\r\n    }\r\n  }\r\n\r\n  getEmbeddingCode (entity) {\r\n    if (entity == null) { return '' }\r\n\r\n    let parts = entity.name.split('.')\r\n    let extension = parts[parts.length - 1]\r\n\r\n    if (this.props.embeddingCode != null) {\r\n      return this.props.embeddingCode\r\n    }\r\n\r\n    if (this.isImage(entity)) {\r\n      return `<img src=\"{#asset ${Studio.resolveEntityPath(entity)} @encoding=dataURI}\" />`\r\n    }\r\n\r\n    if (this.isFont(entity)) {\r\n      return `@font-face {\r\n  font-family: '${parts[0]}';\r\n  src: url({#asset ${Studio.resolveEntityPath(entity)} @encoding=dataURI});\r\n  format('${this.getFormat(extension)}');\r\n}`\r\n    }\r\n\r\n    if (this.isOfficeFile(entity)) {\r\n      return `{#asset ${Studio.resolveEntityPath(entity)} @encoding=base64}`\r\n    }\r\n\r\n    return `{#asset ${Studio.resolveEntityPath(entity)} @encoding=utf8}`\r\n  }\r\n\r\n  getLazyPreviewStatus (entity) {\r\n    if (this.props.lazyPreview != null) {\r\n      return this.props.lazyPreview\r\n    }\r\n\r\n    if (this.isOfficeFile(entity)) {\r\n      return true\r\n    }\r\n\r\n    return false\r\n  }\r\n\r\n  getPreviewEnabledStatus (entity) {\r\n    if (this.props.previewEnabled != null) {\r\n      return this.props.previewEnabled\r\n    }\r\n\r\n    if (this.isOfficeFile(entity)) {\r\n      return Studio.extensions.assets.options.officePreview.enabled !== false\r\n    }\r\n\r\n    return true\r\n  }\r\n\r\n  preview (entity) {\r\n    const { previewOpen } = this.state\r\n    const { onPreview } = this.props\r\n    const lazyPreview = this.getLazyPreviewStatus(entity)\r\n    const previewEnabled = this.getPreviewEnabledStatus(entity)\r\n\r\n    if (!lazyPreview || !previewEnabled) {\r\n      return\r\n    }\r\n\r\n    if (onPreview) {\r\n      onPreview(entity)\r\n    } else if (this.isOfficeFile(entity)) {\r\n      if (\r\n        Studio.extensions.assets.options.officePreview.showWarning !== false &&\r\n        Studio.getSettingValueByKey('office-preview-informed', false) === false\r\n      ) {\r\n        Studio.setSetting('office-preview-informed', true)\r\n\r\n        Studio.openModal(() => (\r\n          <div>\r\n            We need to upload your office asset to our publicly hosted server to be able to use\r\n            Office Online Service for previewing here in the studio. You can disable it in the configuration, see <a\r\n              href='https://jsreport.net/learn/xlsx#preview-in-studio' target='_blank'>the docs</a> for details.\r\n          </div>\r\n        ))\r\n      }\r\n    }\r\n\r\n    if (previewOpen) {\r\n      this.clearPreview(() => {\r\n        this.preview(entity)\r\n      })\r\n    } else {\r\n      Studio.startProgress()\r\n\r\n      this.setState({\r\n        previewLoading: true,\r\n        previewOpen: true,\r\n        helpersActive: false\r\n      })\r\n    }\r\n  }\r\n\r\n  previewLoadFinish () {\r\n    Studio.stopProgress()\r\n\r\n    this.setState({\r\n      previewLoading: false\r\n    })\r\n  }\r\n\r\n  clearPreview (done) {\r\n    this.setState({\r\n      previewOpen: false\r\n    }, () => done && done())\r\n  }\r\n\r\n  renderBinary (entity) {\r\n    return (\r\n      <div className='custom-editor'>\r\n        <div>\r\n          <h1><i className='fa fa-file-o' /> {entity.name}</h1>\r\n        </div>\r\n        <div>\r\n          <a className='button confirmation' target='_blank' href={Studio.resolveUrl(`assets/${entity._id}/content?download=true`)} title='Download'>\r\n            <i className='fa fa-download' /> Download\r\n          </a>\r\n          <button className='button confirmation' onClick={() => AssetUploadButton.OpenUpload()}>\r\n            <i className='fa fa-upload' /> Upload\r\n          </button>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  renderEditorToolbar () {\r\n    const { link, previewLoading, previewOpen, helpersActive } = this.state\r\n    const { entity, helpersEntity, displayName, icon, onDownload, onUpload } = this.props\r\n    const lazyPreview = this.getLazyPreviewStatus(entity)\r\n    const previewEnabled = this.getPreviewEnabledStatus(entity)\r\n    const embeddingCode = this.getEmbeddingCode(entity)\r\n\r\n    let visibleName = displayName\r\n\r\n    if (!visibleName && entity) {\r\n      visibleName = entity.name\r\n    }\r\n\r\n    if (!visibleName) {\r\n      visibleName = '<none>'\r\n    }\r\n\r\n    return (\r\n      <div className={style.toolbarContainer}>\r\n        <div className={style.toolbarRow}>\r\n          <h3 className={style.toolbarAssetName}>\r\n            <div>\r\n              <i className={`fa ${icon}`} />\r\n              &nbsp;\r\n              {entity != null ? (\r\n                <a\r\n                  href='#'\r\n                  onClick={(ev) => {\r\n                    ev.preventDefault()\r\n                    Studio.openTab({ _id: entity._id })\r\n                  }}\r\n                >{visibleName}</a>\r\n              ) : visibleName}\r\n            </div>\r\n          </h3>\r\n          {embeddingCode !== '' && (\r\n            <CopyToClipboard text={embeddingCode}>\r\n              <a className='button confirmation' title='Coppy the embedding code to clipboard'>\r\n                <i className='fa fa-clipboard' />\r\n              </a>\r\n            </CopyToClipboard>\r\n          )}\r\n          {entity != null && (\r\n            <button\r\n              className='button confirmation'\r\n              title='Download'\r\n              onClick={() => {\r\n                if (onDownload) {\r\n                  onDownload(entity)\r\n                } else {\r\n                  const downloadEl = document.createElement('a')\r\n                  downloadEl.target = '_blank'\r\n                  downloadEl.href = Studio.resolveUrl(`assets/${entity._id}/content?download=true`)\r\n                  downloadEl.click()\r\n                }\r\n              }}\r\n            >\r\n              <i className='fa fa-download' />\r\n            </button>\r\n          )}\r\n          {entity != null && !entity.link && (\r\n            <button\r\n              className='button confirmation'\r\n              title='Upload'\r\n              onClick={() => {\r\n                const cb = () => {\r\n                  let wasOpen = false\r\n\r\n                  if (lazyPreview && this.state.previewOpen) {\r\n                    wasOpen = true\r\n                  }\r\n\r\n                  this.clearPreview(() => {\r\n                    if (wasOpen) {\r\n                      this.preview(entity)\r\n                    }\r\n                  })\r\n                }\r\n\r\n                if (onUpload) {\r\n                  onUpload(entity, cb)\r\n                } else {\r\n                  AssetUploadButton.OpenUpload({\r\n                    targetAsset: {\r\n                      _id: entity._id,\r\n                      name: entity.name\r\n                    },\r\n                    uploadCallback: cb\r\n                  })\r\n                }\r\n              }}\r\n            >\r\n              <i className='fa fa-upload' />\r\n            </button>\r\n          )}\r\n          {lazyPreview && entity != null && (\r\n            <button\r\n              className={`button confirmation ${!previewEnabled || previewLoading ? 'disabled' : ''}`}\r\n              onClick={() => this.preview(entity)}\r\n              title={previewOpen ? 'Refresh' : 'Preview'}\r\n            >\r\n              <i className={`fa fa-${previewLoading ? '' : previewOpen ? 'retweet' : 'eye'}`} /> {previewLoading ? 'Loading..' : ''}\r\n            </button>\r\n          )}\r\n          {lazyPreview && entity != null && previewOpen && !previewLoading && (\r\n            <button\r\n              className={`button confirmation ${!previewEnabled || previewLoading ? 'disabled' : ''}`}\r\n              onClick={() => this.clearPreview()}\r\n              title='Clear'\r\n            >\r\n              <i className='fa fa-times' />\r\n            </button>\r\n          )}\r\n          {helpersEntity != null && (\r\n            <button\r\n              className={`button ${helpersActive ? 'danger' : 'confirmation'}`}\r\n              onClick={() => this.setState((state) => {\r\n                const change = {}\r\n\r\n                if (state.helpersActive) {\r\n                  Studio.store.dispatch(Studio.entities.actions.flushUpdates())\r\n                } else {\r\n                  change.previewOpen = false\r\n                  change.previewLoading = false\r\n                  Studio.stopProgress()\r\n                }\r\n\r\n                return { helpersActive: !state.helpersActive, ...change }\r\n              })}\r\n              title={`${helpersActive ? 'Hide' : 'Show'} helpers`}\r\n            >\r\n              <i className='fa fa-code' />\r\n            </button>\r\n          )}\r\n        </div>\r\n        {entity != null && entity.link && (\r\n          <div className={style.toolbarRow} style={{ margin: '0.6rem' }}>\r\n            <span><b><i className='fa fa-folder-open' /> linked to file:</b> {link}</span>\r\n          </div>\r\n        )}\r\n      </div>\r\n    )\r\n  }\r\n\r\n  renderEditorContent () {\r\n    const { entity, helpersEntity, emptyMessage, getPreviewContent, onUpdate } = this.props\r\n    const { helpersActive } = this.state\r\n\r\n    if (helpersEntity != null && helpersActive) {\r\n      return (\r\n        <TextEditor\r\n          key={helpersEntity._id + '_helpers'}\r\n          name={helpersEntity._id + '_helpers'}\r\n          getFilename={() => `${helpersEntity.name} (helpers)`}\r\n          mode='javascript'\r\n          onUpdate={(v) => onUpdate(Object.assign({ _id: helpersEntity._id }, { helpers: v }))}\r\n          value={helpersEntity.helpers || ''}\r\n        />\r\n      )\r\n    }\r\n\r\n    if (entity == null) {\r\n      return (\r\n        <div style={{ padding: '2rem' }}>\r\n          <i>{emptyMessage != null ? emptyMessage : 'Asset is empty'}</i>\r\n        </div>\r\n      )\r\n    }\r\n\r\n    let parts = entity.name.split('.')\r\n    let extension = parts[parts.length - 1]\r\n    const lazyPreview = this.getLazyPreviewStatus(entity)\r\n\r\n    let previewOpen = true\r\n\r\n    if (lazyPreview) {\r\n      previewOpen = this.state.previewOpen\r\n    }\r\n\r\n    if (!previewOpen) {\r\n      return null\r\n    }\r\n\r\n    if (getPreviewContent) {\r\n      return getPreviewContent(entity, {\r\n        previewLoadFinish: this.previewLoadFinish\r\n      })\r\n    }\r\n\r\n    if (this.isImage(entity)) {\r\n      return (\r\n        <div style={{ overflow: 'auto' }}>\r\n          <img\r\n            src={Studio.resolveUrl(`assets/${entity._id}/content?v=${new Date().getTime()}`)}\r\n            style={{display: 'block', margin: '3rem auto'}}\r\n          />\r\n        </div>\r\n      )\r\n    }\r\n\r\n    if (this.isFont(entity)) {\r\n      let newStyle = document.createElement('style')\r\n\r\n      newStyle.appendChild(document.createTextNode(`@font-face {\r\n         font-family: '${parts[0]}';\r\n         src: url('${Studio.resolveUrl(`/assets/${entity._id}/content`)}');\r\n         format('${extension === 'ttf' ? 'truetype' : 'woff'}');\r\n        }`))\r\n\r\n      document.head.appendChild(newStyle)\r\n\r\n      return (\r\n        <div style={{overflow: 'auto', fontFamily: parts[0], padding: '2rem'}}><h1> Hello world font {entity.name}</h1>\r\n          <p>\r\n            Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's\r\n            standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to\r\n            make a type specimen book.\r\n          </p>\r\n        </div>\r\n      )\r\n    }\r\n\r\n    if (this.isPdf(entity)) {\r\n      return (\r\n        <div className='block' style={{height: '100%'}}>\r\n          <object style={{height: '100%'}} data={Studio.resolveUrl(`assets/${entity._id}/content?v=${new Date().getTime()}`)} type='application/pdf'>\r\n            <embed src={Studio.resolveUrl(`assets/${entity._id}/content?v=${new Date().getTime()}`)} type='application/pdf' />\r\n          </object>\r\n        </div>\r\n      )\r\n    }\r\n\r\n    if (this.isOfficeFile(entity)) {\r\n      return (\r\n        <Preview\r\n          onLoad={() => this.previewLoadFinish()}\r\n          initialSrc={Studio.resolveUrl(`assets/office/${entity._id}/content`)}\r\n        />\r\n      )\r\n    }\r\n\r\n    if (entity.name.split('.').length > 1 && binaryExtensions.includes(entity.name.split('.')[1])) {\r\n      return this.renderBinary(entity)\r\n    }\r\n\r\n    let mode = parts[parts.length - 1]\r\n\r\n    if (extension === 'js') {\r\n      mode = 'javascript'\r\n    }\r\n\r\n    if (extension === 'html') {\r\n      mode = 'handlebars'\r\n    }\r\n\r\n    const content = ((entity.content || entity.forceUpdate) ? entity.content : this.state.content) || ''\r\n\r\n    return (\r\n      <TextEditor\r\n        name={entity._id}\r\n        mode={mode}\r\n        value={decodeURIComponent(escape(atob(content)))}\r\n        onUpdate={(v) => this.props.onUpdate(Object.assign({}, entity, {content: btoa(unescape(encodeURIComponent(v))), forceUpdate: true}))}\r\n      />\r\n    )\r\n  }\r\n\r\n  render () {\r\n    const { initialLoading } = this.state\r\n\r\n    if (initialLoading) {\r\n      return <div />\r\n    }\r\n\r\n    return (\r\n      <div className='block'>\r\n        {this.renderEditorToolbar()}\r\n        {this.renderEditorContent()}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nAssetEditor.defaultProps = {\r\n  icon: 'fa-file-o'\r\n}\r\n\r\nexport default AssetEditor\r\n","module.exports = Studio.libraries['superagent'];","module.exports = Studio.libraries['bluebird'];","'use strict';\n\nvar _require = require('./Component'),\n    CopyToClipboard = _require.CopyToClipboard;\n\nmodule.exports = CopyToClipboard;\n//# sourceMappingURL=index.js.map","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CopyToClipboard = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _copyToClipboard = require('copy-to-clipboard');\n\nvar _copyToClipboard2 = _interopRequireDefault(_copyToClipboard);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nvar CopyToClipboard = _react2.default.createClass({\n  displayName: 'CopyToClipboard',\n\n  propTypes: {\n    text: _react2.default.PropTypes.string.isRequired,\n    children: _react2.default.PropTypes.element.isRequired,\n    onCopy: _react2.default.PropTypes.func,\n    options: _react2.default.PropTypes.shape({\n      debug: _react2.default.PropTypes.bool,\n      message: _react2.default.PropTypes.string\n    })\n  },\n\n  onClick: function onClick(event) {\n    var _props = this.props,\n        text = _props.text,\n        onCopy = _props.onCopy,\n        children = _props.children,\n        options = _props.options;\n\n\n    var elem = _react2.default.Children.only(children);\n\n    var result = (0, _copyToClipboard2.default)(text, options);\n\n    if (onCopy) {\n      onCopy(text, result);\n    }\n\n    // Bypass onClick if it was present\n    if (elem && elem.props && typeof elem.props.onClick === 'function') {\n      elem.props.onClick(event);\n    }\n  },\n  render: function render() {\n    var _props2 = this.props,\n        _text = _props2.text,\n        _onCopy = _props2.onCopy,\n        _options = _props2.options,\n        children = _props2.children,\n        props = _objectWithoutProperties(_props2, ['text', 'onCopy', 'options', 'children']);\n\n    var elem = _react2.default.Children.only(children);\n\n    return _react2.default.cloneElement(elem, _extends({}, props, { onClick: this.onClick }));\n  }\n});\nexports.CopyToClipboard = CopyToClipboard;\n//# sourceMappingURL=Component.js.map","'use strict';\n\nvar deselectCurrent = require('toggle-selection');\n\nvar defaultMessage = 'Copy to clipboard: #{key}, Enter';\n\nfunction format(message) {\n  var copyKey = (/mac os x/i.test(navigator.userAgent) ? '⌘' : 'Ctrl') + '+C';\n  return message.replace(/#{\\s*key\\s*}/g, copyKey);\n}\n\nfunction copy(text, options) {\n  var debug, message, reselectPrevious, range, selection, mark, success = false;\n  if (!options) { options = {}; }\n  debug = options.debug || false;\n  try {\n    reselectPrevious = deselectCurrent();\n\n    range = document.createRange();\n    selection = document.getSelection();\n\n    mark = document.createElement('span');\n    mark.textContent = text;\n    // reset user styles for span element\n    mark.style.all = 'unset';\n    // prevents scrolling to the end of the page\n    mark.style.position = 'fixed';\n    mark.style.top = 0;\n    mark.style.clip = 'rect(0, 0, 0, 0)';\n    // used to preserve spaces and line breaks\n    mark.style.whiteSpace = 'pre';\n    // do not inherit user-select (it may be `none`)\n    mark.style.webkitUserSelect = 'text';\n    mark.style.MozUserSelect = 'text';\n    mark.style.msUserSelect = 'text';\n    mark.style.userSelect = 'text';\n\n    document.body.appendChild(mark);\n\n    range.selectNode(mark);\n    selection.addRange(range);\n\n    var successful = document.execCommand('copy');\n    if (!successful) {\n      throw new Error('copy command was unsuccessful');\n    }\n    success = true;\n  } catch (err) {\n    debug && console.error('unable to copy using execCommand: ', err);\n    debug && console.warn('trying IE specific stuff');\n    try {\n      window.clipboardData.setData('text', text);\n      success = true;\n    } catch (err) {\n      debug && console.error('unable to copy using clipboardData: ', err);\n      debug && console.error('falling back to prompt');\n      message = format('message' in options ? options.message : defaultMessage);\n      window.prompt(message, text);\n    }\n  } finally {\n    if (selection) {\n      if (typeof selection.removeRange == 'function') {\n        selection.removeRange(range);\n      } else {\n        selection.removeAllRanges();\n      }\n    }\n\n    if (mark) {\n      document.body.removeChild(mark);\n    }\n    reselectPrevious();\n  }\n\n  return success;\n}\n\nmodule.exports = copy;\n","\nmodule.exports = function () {\n  var selection = document.getSelection();\n  if (!selection.rangeCount) {\n    return function () {};\n  }\n  var active = document.activeElement;\n\n  var ranges = [];\n  for (var i = 0; i < selection.rangeCount; i++) {\n    ranges.push(selection.getRangeAt(i));\n  }\n\n  switch (active.tagName.toUpperCase()) { // .toUpperCase handles XHTML\n    case 'INPUT':\n    case 'TEXTAREA':\n      active.blur();\n      break;\n\n    default:\n      active = null;\n      break;\n  }\n\n  selection.removeAllRanges();\n  return function () {\n    selection.type === 'Caret' &&\n    selection.removeAllRanges();\n\n    if (!selection.rangeCount) {\n      ranges.forEach(function(range) {\n        selection.addRange(range);\n      });\n    }\n\n    active &&\n    active.focus();\n  };\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toolbarContainer\":\"x-assets-AssetEditor-toolbarContainer\",\"toolbarRow\":\"x-assets-AssetEditor-toolbarRow\",\"toolbarAssetName\":\"x-assets-AssetEditor-toolbarAssetName\"};","import React, {Component, PropTypes} from 'react'\r\nimport AssetUploadButton from './AssetUploadButton.js'\r\nimport Studio from 'jsreport-studio'\r\n\r\nexport default class NewAssetModal extends Component {\r\n  constructor () {\r\n    super()\r\n    this.state = { isLink: false }\r\n  }\r\n\r\n  handleKeyPress (e) {\r\n    if (e.key === 'Enter') {\r\n      this.createAsset()\r\n    }\r\n  }\r\n\r\n  // the modal component for some reason after open focuses the panel itself\r\n  componentDidMount () {\r\n    setTimeout(() => this.refs.name.focus(), 0)\r\n  }\r\n\r\n  async createAsset (e) {\r\n    let entity = {}\r\n\r\n    if (!this.state.isLink && (!this.refs.name.value || this.refs.name.value.indexOf('.')) < 0) {\r\n      return this.setState({ error: 'name should include file extension, for example foo.js' })\r\n    }\r\n\r\n    if (this.props.options.defaults != null) {\r\n      entity = Object.assign(entity, this.props.options.defaults)\r\n    }\r\n\r\n    if (this.state.isLink) {\r\n      entity.link = this.refs.link.value\r\n      const fragments = entity.link.split('/')\r\n      entity.name = fragments[fragments.length - 1]\r\n    } else {\r\n      entity.name = this.refs.name.value\r\n    }\r\n\r\n    try {\r\n      if (Studio.workspaces) {\r\n        await Studio.workspaces.save()\r\n      }\r\n\r\n      let response = await Studio.api.post('/odata/assets', {\r\n        data: entity\r\n      })\r\n      response.__entitySet = 'assets'\r\n\r\n      Studio.addExistingEntity(response)\r\n      Studio.openTab(response)\r\n      this.props.close()\r\n    } catch (e) {\r\n      this.setState({ error: e.message })\r\n    }\r\n  }\r\n\r\n  render () {\r\n    const { isLink, error } = this.state\r\n\r\n    return (\r\n      <div>\r\n        {isLink ? (\r\n          <div className='form-group'>\r\n            <label>Relative or absolute path to existing file</label>\r\n            <input type='text' name='link' ref='link' />\r\n          </div>\r\n        ) : (\r\n          <div className='form-group'>\r\n            <label>Name</label>\r\n            <input type='text' name='name' ref='name' placeholder='styles.css' onKeyPress={(e) => this.handleKeyPress(e)} />\r\n          </div>\r\n        )}\r\n        {Studio.extensions.assets.options.allowAssetsLinkedToFiles !== false ? (\r\n          <div className='form-group'>\r\n            <label>link to existing file</label>\r\n            <input\r\n              type='checkbox' checked={isLink}\r\n              onChange={() => this.setState({ isLink: !isLink })} />\r\n          </div>\r\n        ) : <div />}\r\n        <div className='form-group'>\r\n          <span\r\n            style={{color: 'red', display: error ? 'block' : 'none'}}>{error}</span>\r\n        </div>\r\n        <div className='form-group' style={{opacity: 0.8}}>\r\n          <hr />\r\n          <span>You can use assets to embed any kind of static content into report template.<br />\r\n            This can be for example css style, image, font, html or even javascript shared helpers. <br />See the <a\r\n              target='_blank' title='Help' href='http://jsreport.net/learn/assets'>documentation</a> for details.\r\n          </span>\r\n        </div>\r\n        <div className='button-bar'>\r\n          <button\r\n            className='button confirmation'\r\n            onClick={() => { this.props.close(); AssetUploadButton.OpenUploadNew(this.props.options.defaults) }}>Upload\r\n          </button>\r\n          <button onClick={() => this.createAsset()} className={'button confirmation'}>Ok</button>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nNewAssetModal.propTypes = {\r\n  close: PropTypes.func.isRequired\r\n}\r\n","import React, { Component } from 'react'\nimport Studio from 'jsreport-studio'\n\nexport default class AssetProperties extends Component {\n  static title (entity, entities) {\n    return `asset ${entity.link ? '(link)' : ''}`\n  }\n\n  render () {\n    const { entity, onChange } = this.props\n\n    return (\n      <div>\n        {Studio.extensions.assets.options.allowAssetsLinkedToFiles !== false ? (\n          <div className='form-group'>\n            <label>link</label>\n            <input\n              type='text'\n              value={entity.link || ''}\n              onChange={(v) => onChange({ _id: entity._id, link: v.target.value })}\n            />\n          </div>\n        ) : <div />}\n        <div className='form-group'>\n          <label>shared helpers attached to each template</label>\n          <input\n            type='checkbox' checked={entity.isSharedHelper === true}\n            onChange={(v) => onChange({ _id: entity._id, isSharedHelper: v.target.checked })}\n          />\n        </div>\n      </div>\n    )\n  }\n}\n"],"sourceRoot":""}